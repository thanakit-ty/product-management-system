import{r as b,b as D,d as y,e as tt,f as et,c as st,w as ot,h as V,u as lt,o as d,a as e,g as u,i as _,j as T,v as nt,F as z,k as E,t as a,l as U,m as c,n as N,p as L}from"./index-C5d7Pc4o.js";import{A as it}from"./AppLayout-CHHhpvw4.js";const rt={class:"space-y-6"},at={class:"rounded-xl border border-slate-200 bg-white p-4"},dt={class:"grid grid-cols-1 gap-3 md:grid-cols-12 md:items-end"},ut={class:"md:col-span-5"},ct={class:"md:col-span-3"},pt=["value"],xt={class:"md:col-span-2"},gt={class:"md:col-span-2"},ft={class:"flex gap-2 md:justify-end"},mt=["disabled"],bt=["disabled"],yt={key:0,class:"mt-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},vt={class:"overflow-hidden rounded-xl border border-slate-200 bg-white"},ht={class:"overflow-x-auto"},wt={class:"min-w-full divide-y divide-slate-200"},_t={class:"bg-slate-50"},kt={class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"},At={class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"},Ct={class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"},Dt={class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"},Nt={class:"divide-y divide-slate-100"},St={key:0},Mt={key:1},jt={class:"px-4 py-12",colspan:"8"},Pt={class:"mx-auto max-w-lg text-center"},Tt={class:"text-sm font-semibold text-slate-900"},$t={class:"mt-1 text-sm text-slate-600"},Ft={key:0,class:"mt-4"},Bt={class:"whitespace-nowrap px-4 py-3 text-sm font-semibold text-slate-900"},Vt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-700"},zt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-700"},Et={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-700"},Ut={class:"whitespace-nowrap px-4 py-3 text-sm"},Lt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-700"},It={class:"whitespace-nowrap px-4 py-3 text-right text-sm"},Kt={class:"inline-flex items-center justify-end gap-2"},Rt=["onClick"],Ht=["onClick"],Ot={class:"flex flex-col gap-3 border-t border-slate-200 bg-white px-4 py-3 sm:flex-row sm:items-center sm:justify-between"},qt={class:"text-sm text-slate-600"},Gt={class:"font-semibold text-slate-900"},Jt={class:"mx-1 font-semibold text-slate-900"},Qt={class:"mx-1 font-semibold text-slate-900"},Wt={class:"flex items-center gap-2"},Xt=["disabled"],Yt=["disabled"],Zt={key:0,class:"fixed inset-0 z-50"},te={class:"absolute inset-0 flex items-center justify-center p-4"},ee={class:"w-full max-w-md rounded-xl border border-slate-200 bg-white shadow-xl"},se={class:"p-5"},oe={class:"mt-1 text-sm text-slate-600"},le={class:"font-semibold text-slate-900"},ne={key:0,class:"mt-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},ie={class:"flex items-center justify-end gap-2 border-t border-slate-200 bg-slate-50 px-5 py-3"},re=["disabled"],ae=["disabled"],de={key:0,class:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-white/60 border-t-white"},ue=500,ge={__name:"ProductListView",setup(ce){const k={props:{active:{type:Boolean,default:!1},dir:{type:String,default:"asc"}},template:`
        <span class="inline-flex items-center" aria-hidden="true">
            <svg v-if="active && dir === 'asc'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-4 w-4 text-slate-700">
                <path fill-rule="evenodd" d="M10 3a1 1 0 01.832.445l4 6A1 1 0 0114 11H6a1 1 0 01-.832-1.555l4-6A1 1 0 0110 3z" clip-rule="evenodd" />
            </svg>
            <svg v-else-if="active && dir === 'desc'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-4 w-4 text-slate-700">
                <path fill-rule="evenodd" d="M10 17a1 1 0 01-.832-.445l-4-6A1 1 0 016 9h8a1 1 0 01.832 1.555l-4 6A1 1 0 0110 17z" clip-rule="evenodd" />
            </svg>
            <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-4 w-4 text-slate-400">
                <path d="M10 3a1 1 0 01.832.445l3 4.5A1 1 0 0113 9H7a1 1 0 01-.832-1.555l3-4.5A1 1 0 0110 3z" />
                <path d="M10 17a1 1 0 01-.832-.445l-3-4.5A1 1 0 017 11h6a1 1 0 01.832 1.555l-3 4.5A1 1 0 0110 17z" />
            </svg>
        </span>
    `},$=lt(),g=b([]),v=b(0),p=b(!1),A=b(""),S=b([]),n=D({search:"",category:"",status:""}),r=D({key:"updatedAt",dir:"desc"}),i=D({page:1,limit:10}),l=D({open:!1,product:null,isDeleting:!1,error:""}),M=b(null),I=y(()=>{const s=r.key;return s?r.dir==="desc"?`-${s}`:s:""}),h=y(()=>{const s=Math.ceil((Number(v.value)||0)/i.limit);return Math.max(1,s||1)}),K=y(()=>!!(n.search||n.category||n.status)),j=y(()=>!K.value&&v.value===0),R=y(()=>j.value?"No products yet":"No results found"),H=y(()=>j.value?"Create your first product to start building your catalog.":"Try adjusting your filters or search terms.");function O(s){const t=Number.isFinite(Number(s))?Number(s):0;return new Intl.NumberFormat(void 0,{style:"currency",currency:"USD"}).format(t)}function q(s){if(!s)return"";const t=new Date(s);return Number.isNaN(t.getTime())?"":t.toLocaleDateString()}function G(s){const t=Array.isArray(s)?s:Array.isArray(s?.items)?s.items:Array.isArray(s?.data)?s.data:Array.isArray(s?.products)?s.products:[],o=typeof s?.total=="number"?s.total:typeof s?.count=="number"?s.count:typeof s?.meta?.total=="number"?s.meta.total:Array.isArray(t)?t.length:0,f=Array.isArray(s?.categories)?s.categories:Array.isArray(s?.meta?.categories)?s.meta.categories:null;return{items:t,totalCount:o,categories:f}}async function x(){p.value=!0,A.value="";try{const s=await V.get("/products",{params:{search:n.search||"",category:n.category||"",status:n.status||"",sort:I.value||"",page:i.page,limit:i.limit}}),{items:t,totalCount:o,categories:f}=G(s.data);if(g.value=Array.isArray(t)?t:[],v.value=Number.isFinite(Number(o))?Number(o):0,Array.isArray(f))S.value=f.filter(w=>typeof w=="string"&&w.trim()!=="");else{const w=new Set(g.value.map(m=>m?.category).filter(m=>typeof m=="string"&&m.trim()!==""));n.category&&w.add(n.category),S.value=Array.from(w).sort((m,Z)=>m.localeCompare(Z))}i.page>h.value&&(i.page=h.value)}catch(s){const t=s?.response?.data?.message||s?.message||"Failed to load products";A.value=t,g.value=[],v.value=0}finally{p.value=!1}}function C(s){new Set(["name","price","stock","updatedAt"]).has(s)&&(r.key===s?r.dir=r.dir==="asc"?"desc":"asc":(r.key=s,r.dir="asc"),i.page=1,x())}function F(s){const t=Math.min(Math.max(1,s),h.value);t!==i.page&&(i.page=t,x())}function J(){i.page=1,x()}function Q(){n.search="",n.category="",n.status="",r.key="updatedAt",r.dir="desc",i.page=1,x()}function B(){$.push("/products/new")}function W(s){$.push(`/products/${s}`)}function X(s){l.open=!0,l.product=s,l.isDeleting=!1,l.error=""}function P(){l.isDeleting||(l.open=!1,l.product=null,l.error="")}async function Y(){const s=l.product;if(s?._id){l.isDeleting=!0,l.error="";try{await V.delete(`/products/${s._id}`),g.value.length===1&&i.page>1&&(i.page-=1),P(),await x()}catch(t){l.error=t?.response?.data?.message||t?.message||"Failed to delete product"}finally{l.isDeleting=!1}}}return tt(()=>{x()}),et(()=>n.search,()=>{M.value&&clearTimeout(M.value),M.value=setTimeout(()=>{i.page=1,x()},ue)}),(s,t)=>(d(),st(it,null,{default:ot(()=>[e("div",rt,[e("div",{class:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between"},[t[9]||(t[9]=e("div",null,[e("h2",{class:"text-2xl font-semibold tracking-tight text-slate-900"},"Products"),e("p",{class:"mt-1 text-sm text-slate-600"},"Manage your product catalog")],-1)),e("div",{class:"flex items-center gap-3"},[e("button",{type:"button",class:"inline-flex items-center justify-center rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-400 disabled:opacity-60",onClick:B}," + Add Product ")])]),e("div",at,[e("div",dt,[e("div",ut,[t[10]||(t[10]=e("label",{class:"block text-xs font-semibold text-slate-700"},"Search",-1)),T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>n.search=o),type:"text",class:"mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200",placeholder:"Search by name or SKU",autocomplete:"off"},null,512),[[nt,n.search,void 0,{trim:!0}]])]),e("div",ct,[t[12]||(t[12]=e("label",{class:"block text-xs font-semibold text-slate-700"},"Category",-1)),T(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>n.category=o),class:"mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200"},[t[11]||(t[11]=e("option",{value:""},"All categories",-1)),(d(!0),u(z,null,E(S.value,o=>(d(),u("option",{key:o,value:o},a(o),9,pt))),128))],512),[[U,n.category]])]),e("div",xt,[t[14]||(t[14]=e("label",{class:"block text-xs font-semibold text-slate-700"},"Status",-1)),T(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>n.status=o),class:"mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200"},[...t[13]||(t[13]=[e("option",{value:""},"All",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)])],512),[[U,n.status]])]),e("div",gt,[e("div",ft,[e("button",{type:"button",class:"inline-flex w-full items-center justify-center rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-800 transition hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-200 disabled:opacity-60",onClick:Q,disabled:p.value}," Reset ",8,mt),e("button",{type:"button",class:"inline-flex w-full items-center justify-center rounded-lg bg-slate-900 px-3 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-400 disabled:opacity-60",onClick:J,disabled:p.value}," Apply ",8,bt)])])]),A.value?(d(),u("div",yt,a(A.value),1)):_("",!0)]),e("div",vt,[e("div",ht,[e("table",wt,[e("thead",_t,[e("tr",null,[e("th",kt,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-slate-900",onClick:t[3]||(t[3]=o=>C("name"))},[t[15]||(t[15]=c(" Name ",-1)),N(k,{active:r.key==="name",dir:r.dir},null,8,["active","dir"])])]),t[19]||(t[19]=e("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"},"SKU",-1)),t[20]||(t[20]=e("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"},"Category",-1)),e("th",At,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-slate-900",onClick:t[4]||(t[4]=o=>C("price"))},[t[16]||(t[16]=c(" Price ",-1)),N(k,{active:r.key==="price",dir:r.dir},null,8,["active","dir"])])]),e("th",Ct,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-slate-900",onClick:t[5]||(t[5]=o=>C("stock"))},[t[17]||(t[17]=c(" Stock ",-1)),N(k,{active:r.key==="stock",dir:r.dir},null,8,["active","dir"])])]),t[21]||(t[21]=e("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600"},"Status",-1)),e("th",Dt,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-slate-900",onClick:t[6]||(t[6]=o=>C("updatedAt"))},[t[18]||(t[18]=c(" Updated At ",-1)),N(k,{active:r.key==="updatedAt",dir:r.dir},null,8,["active","dir"])])]),t[22]||(t[22]=e("th",{class:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600"},"Actions",-1))])]),e("tbody",Nt,[p.value?(d(),u("tr",St,[...t[23]||(t[23]=[e("td",{class:"px-4 py-10",colspan:"8"},[e("div",{class:"flex items-center justify-center gap-3 text-sm text-slate-600"},[e("span",{class:"h-4 w-4 animate-spin rounded-full border-2 border-slate-300 border-t-slate-700"}),c(" Loading productsâ€¦ ")])],-1)])])):g.value.length===0?(d(),u("tr",Mt,[e("td",jt,[e("div",Pt,[e("div",Tt,a(R.value),1),e("div",$t,a(H.value),1),j.value?(d(),u("div",Ft,[e("button",{type:"button",class:"inline-flex items-center justify-center rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-400",onClick:B}," + Add Product ")])):_("",!0)])])])):(d(!0),u(z,{key:2},E(g.value,o=>(d(),u("tr",{key:o._id},[e("td",Bt,a(o.name),1),e("td",Vt,a(o.sku),1),e("td",zt,a(o.category),1),e("td",Et,a(O(o.price)),1),e("td",{class:L(["whitespace-nowrap px-4 py-3 text-sm",o.stock<5?"text-red-600 font-semibold":"text-slate-700"])},a(o.stock),3),e("td",Ut,[e("span",{class:L(["inline-flex items-center rounded-full px-2 py-1 text-xs font-semibold",o.status==="active"?"bg-green-50 text-green-700 ring-1 ring-inset ring-green-200":"bg-slate-100 text-slate-700 ring-1 ring-inset ring-slate-200"])},a(o.status==="active"?"Active":"Inactive"),3)]),e("td",Lt,a(q(o.updatedAt)),1),e("td",It,[e("div",Kt,[e("button",{type:"button",class:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-semibold text-slate-800 transition hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-200",onClick:f=>W(o._id)}," Edit ",8,Rt),e("button",{type:"button",class:"rounded-lg border border-red-200 bg-white px-3 py-1.5 text-sm font-semibold text-red-700 transition hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-100",onClick:f=>X(o)}," Delete ",8,Ht)])])]))),128))])])]),e("div",Ot,[e("div",qt,[e("span",Gt,a(v.value),1),t[24]||(t[24]=e("span",null," total",-1)),t[25]||(t[25]=e("span",{class:"mx-2 text-slate-300"},"|",-1)),t[26]||(t[26]=e("span",null,"Page",-1)),e("span",Jt,a(i.page),1),t[27]||(t[27]=e("span",null,"of",-1)),e("span",Qt,a(h.value),1)]),e("div",Wt,[e("button",{type:"button",class:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-semibold text-slate-800 transition hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-200 disabled:opacity-50",onClick:t[7]||(t[7]=o=>F(i.page-1)),disabled:p.value||i.page<=1}," Previous ",8,Xt),e("button",{type:"button",class:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-semibold text-slate-800 transition hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-200 disabled:opacity-50",onClick:t[8]||(t[8]=o=>F(i.page+1)),disabled:p.value||i.page>=h.value}," Next ",8,Yt)])])])]),l.open?(d(),u("div",Zt,[e("div",{class:"absolute inset-0 bg-slate-900/50",onClick:P}),e("div",te,[e("div",ee,[e("div",se,[t[30]||(t[30]=e("h3",{class:"text-base font-semibold text-slate-900"},"Delete product",-1)),e("p",oe,[t[28]||(t[28]=c(" Are you sure you want to delete ",-1)),e("span",le,a(l.product?.name),1),t[29]||(t[29]=c("? This action cannot be undone. ",-1))]),l.error?(d(),u("div",ne,a(l.error),1)):_("",!0)]),e("div",ie,[e("button",{type:"button",class:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-semibold text-slate-800 transition hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-200 disabled:opacity-50",onClick:P,disabled:l.isDeleting}," Cancel ",8,re),e("button",{type:"button",class:"inline-flex items-center justify-center rounded-lg bg-red-600 px-3 py-1.5 text-sm font-semibold text-white shadow-sm transition hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-200 disabled:opacity-50",onClick:Y,disabled:l.isDeleting},[l.isDeleting?(d(),u("span",de)):_("",!0),t[31]||(t[31]=c(" Delete ",-1))],8,ae)])])])])):_("",!0)]),_:1}))}};export{ge as default};
